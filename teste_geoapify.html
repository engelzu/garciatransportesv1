<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Geoapify (JS Local / Sem CSS)</title>
    <script src="./libs/geoapify-autocomplete.min.js"></script>

    <style>
        /* Estilos CSS (permanecem os mesmos) */
        body { background-color: #1f2937; color: white; padding: 20px; font-family: sans-serif; }
        input { width: 90%; padding: 8px; margin-bottom: 15px; background-color: #374151; color: white; border: 1px solid #4b5563; border-radius: 4px; }
        .autocomplete-container { position: relative; margin-bottom: 20px; }
        /* Estilos inline MÍNIMOS para o dropdown */
        .geoapify-autocomplete-items {
            position: absolute; left: 0; right: 0;
            background-color: #374151 !important;
            border: 1px solid #4b5563 !important; border-top: none;
            border-radius: 0 0 4px 4px;
            color: white !important; z-index: 1000 !important;
            max-height: 250px; overflow-y: auto; margin-top: -1px;
        }
        .geoapify-autocomplete-items div { padding: 10px !important; cursor: pointer; font-size: 14px; color: white !important; }
        .geoapify-autocomplete-items div:hover { background-color: #4b5563 !important; }
        .geoapify-autocomplete-item.active { background-color: #00ffff !important; color: black !important; }
        /* Estilo para o input */
        .geoapify-autocomplete-input { background-color: #374151 !important; color: white !important; border: 1px solid #4b5563 !important; border-radius: 4px !important; padding: 8px !important; width: 90% !important; box-sizing: border-box !important; }
        input:focus { border-color: #00ffff !important; outline: none !important; box-shadow: 0 0 0 2px rgba(0, 255, 255, 0.5) !important; }
    </style>
</head>
<body>

    <h1>Teste Geoapify Autocomplete (JS Local / Sem CSS Externo)</h1>

    <div class="autocomplete-container">
        <label for="origem-teste">Origem:</label>
        <input type="text" id="origem-teste" placeholder="Digite origem">
    </div>

    <div class="autocomplete-container">
        <label for="destino-teste">Destino:</label>
        <input type="text" id="destino-teste" placeholder="Digite destino">
    </div>

    <div id="status-teste" style="margin-top: 20px; color: #facc15;">Aguardando inicialização...</div>

    <script>
        // Executa o script DEPOIS que a página carregar
        window.addEventListener('load', () => {
            const statusDiv = document.getElementById('status-teste');
            const geoapifyApiKey = '3bd73ecada1d478a8c9473ad4115be38'; // Sua chave API

            // Verifica se a biblioteca Autocomplete foi definida
            // Adiciona um pequeno delay para dar mais tempo ao script externo carregar
            setTimeout(() => {
                if (typeof Autocomplete !== 'undefined') {
                    statusDiv.textContent = "Biblioteca JS local detectada. Inicializando...";
                    console.log("Biblioteca Autocomplete DEFINIDA. Inicializando...");

                    try {
                        // Inicializa Origem
                        new Autocomplete(document.getElementById('origem-teste'), {
                            apiKey: geoapifyApiKey, filter: { countrycode: ['br'] }, lang: 'pt'
                        });
                        console.log("Autocomplete Origem OK.");

                        // Inicializa Destino
                        new Autocomplete(document.getElementById('destino-teste'), {
                            apiKey: geoapifyApiKey, filter: { countrycode: ['br'] }, lang: 'pt'
                        });
                        console.log("Autocomplete Destino OK.");

                        statusDiv.textContent = "Autocomplete inicializado! Teste a digitação.";
                        statusDiv.style.color = "#22c55e"; // Verde

                    } catch (e) {
                        console.error("Erro DURANTE a inicialização do Autocomplete:", e);
                        statusDiv.textContent = "ERRO ao inicializar Autocomplete (pós-carregamento). Verifique o console.";
                        statusDiv.style.color = "#ef4444"; // Vermelho
                    }

                } else {
                    console.error("ERRO CRÍTICO: A biblioteca Autocomplete (local) NÃO está definida após window.onload e delay.");
                    statusDiv.textContent = "ERRO CRÍTICO: Biblioteca Autocomplete JS local não carregou/definiu 'Autocomplete'. Verifique Console/Rede.";
                    statusDiv.style.color = "#ef4444"; // Vermelho
                }
            }, 200); // Delay de 200ms
        });
    </script>

</body>
</html>
